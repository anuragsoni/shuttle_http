<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Input_channel (shuttle.Shuttle.Input_channel)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.0-97-ga52dd8e"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">shuttle</a> &#x00BB; <a href="../index.html">Shuttle</a> &#x00BB; Input_channel</nav><header class="odoc-preamble"><h1>Module <code><span>Shuttle.Input_channel</span></code></h1><p>Alternative to <a href="https://github.com/janestreet/async_unix/blob/cdd9aba67eec2f30bb3a7a22f92c056742073726/src/reader.mli">Async_unix.Reader</a>, based on the low latency transport in async_rpc.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sexp_of_t"><a href="#val-sexp_of_t" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_t : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-create"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : <span>?max_buffer_size:int <span class="arrow">&#45;&gt;</span></span> <span>?buf_len:int <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Async_unix</span>.Fd.t <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_closed"><a href="#val-is_closed" class="anchor"></a><code><span><span class="keyword">val</span> is_closed : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-closed"><a href="#val-closed" class="anchor"></a><code><span><span class="keyword">val</span> closed : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Async_kernel</span>.Deferred.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-close"><a href="#val-close" class="anchor"></a><code><span><span class="keyword">val</span> close : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Async_kernel</span>.Deferred.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-refill"><a href="#val-refill" class="anchor"></a><code><span><span class="keyword">val</span> refill : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Ok <span>| `Eof</span> ]</span> <span class="xref-unresolved">Async_kernel</span>.Deferred.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-view"><a href="#val-view" class="anchor"></a><code><span><span class="keyword">val</span> view : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Core</span>.Bigstring.t <span class="xref-unresolved">Core_unix</span>.IOVec.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-consume"><a href="#val-consume" class="anchor"></a><code><span><span class="keyword">val</span> consume : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-drain"><a href="#val-drain" class="anchor"></a><code><span><span class="keyword">val</span> drain : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Async_kernel</span>.Deferred.t</span></span></code></div><div class="spec-doc"><p><code>drain t</code> reads chunks of data from the reader and discards them.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pipe"><a href="#val-pipe" class="anchor"></a><code><span><span class="keyword">val</span> pipe : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="xref-unresolved">Async_kernel</span>.Pipe.Reader.t</span></span></code></div><div class="spec-doc"><p><code>pipe</code> returns a reader pipe that contains the results of reading chunks from an input_channel.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-transfer"><a href="#val-transfer" class="anchor"></a><code><span><span class="keyword">val</span> transfer : 
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>string <span class="xref-unresolved">Async_kernel</span>.Pipe.Writer.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="xref-unresolved">Async_kernel</span>.Deferred.t</span></span></code></div><div class="spec-doc"><p><code>transfer</code> will read chunks from an input channel and write them to the provided writer end of an async pipe. The deferred returned by the function will be determined on EOF or if the writer is closed. Use <code>transfer</code> in scenarios where <code>pipe</code> is needed, but if there is a need to not close the channel automatically once the transfer is finished.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-of_pipe"><a href="#val-of_pipe" class="anchor"></a><code><span><span class="keyword">val</span> of_pipe : 
  <span><span class="xref-unresolved">Core</span>.Info.t <span class="arrow">&#45;&gt;</span></span>
  <span><span>string <span class="xref-unresolved">Async_kernel</span>.Pipe.Reader.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="xref-unresolved">Async_kernel</span>.Deferred.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-read_line"><a href="#val-read_line" class="anchor"></a><code><span><span class="keyword">val</span> read_line : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>[ <span>`Ok of string</span> <span>| `Eof</span> ]</span> <span class="xref-unresolved">Async_kernel</span>.Deferred.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-lines"><a href="#val-lines" class="anchor"></a><code><span><span class="keyword">val</span> lines : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="xref-unresolved">Async_kernel</span>.Pipe.Reader.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-read"><a href="#val-read" class="anchor"></a><code><span><span class="keyword">val</span> read : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span><span>[ <span>`Ok of string</span> <span>| `Eof</span> ]</span> <span class="xref-unresolved">Async_kernel</span>.Deferred.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-open_file"><a href="#val-open_file" class="anchor"></a><code><span><span class="keyword">val</span> open_file : <span>?buf_len:int <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Core</span>.Filename.t <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="xref-unresolved">Async_kernel</span>.Deferred.t</span></span></code></div><div class="spec-doc"><p><code>open_file ?buf_len filename</code> opens <code>filename</code> and returns an <code>Input_channel</code> that can be used to read from the file. <code>buf_len</code> is an optional input and can be used to control the channel's buffer size.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-with_file"><a href="#val-with_file" class="anchor"></a><code><span><span class="keyword">val</span> with_file : 
  <span>?buf_len:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Core</span>.Filename.t <span class="arrow">&#45;&gt;</span></span>
  <span>f:<span>(<span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="xref-unresolved">Async_kernel</span>.Deferred.t</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <span class="xref-unresolved">Async_kernel</span>.Deferred.t</span></span></code></div><div class="spec-doc"><p><code>with_file ?buf_len filename ~f</code> opens <code>filename</code>, creates a new channel and passes it to <code>f</code>. Once <code>f</code> returns, the channel and the underlying file is closed.</p></div></div></div></body></html>