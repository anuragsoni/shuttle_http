<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Client (shuttle_http.Shuttle_http.Client)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.2.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">shuttle_http</a> &#x00BB; <a href="../index.html">Shuttle_http</a> &#x00BB; Client</nav><header class="odoc-preamble"><h1>Module <code><span>Shuttle_http.Client</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec module anchored" id="module-Address"><a href="#module-Address" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Address/index.html">Address</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Ssl"><a href="#module-Ssl" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Ssl/index.html">Ssl</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span></code></div><div class="spec-doc"><p>HTTP/1.1 client that supports keep-alives. A client entity can be created once with an <a href="Address/index.html#type-t">address</a> and re-used for multiple requests. The client is closed either when a user explicitly <a href="#val-close">closes</a> it, or if there is an exception when performing a HTTP request using the client.</p><p>It is the responsiblity of the user to check that a http call raised an exception and avoid using a connection once an exception is seen in a call.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sexp_of_t"><a href="#val-sexp_of_t" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_t : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-create"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : 
  <span>?interrupt:<span>unit <span class="xref-unresolved">Async</span>.Deferred.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?connect_timeout:<span class="xref-unresolved">Core</span>.Time.Span.t <span class="arrow">&#45;&gt;</span></span>
  <span>?ssl:<a href="Ssl/index.html#type-t">Ssl.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="Address/index.html#type-t">Address.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="xref-unresolved">Async</span>.Deferred.Or_error.t</span></span></code></div><div class="spec-doc"><p>Initiate a TCP connection targeting the user provided Address and perform SSL handshake if needed. If an interrup deferred is provided the underlying socket is closed when it resolves. If address is a host + port pair the client will automatically populate the Host HTTP header for outgoing calls, and ensure that SNI and hostname validation is configured if using an SSL connection.</p></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Remote_connection_closed"><a href="#exception-Remote_connection_closed" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Remote_connection_closed</span></span></code></div><div class="spec-doc"><p><code>Remote_connection_closed</code> is raised if attempting if an EOF is reached before the full response has been read.</p></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Request_aborted"><a href="#exception-Request_aborted" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Request_aborted</span></span></code></div><div class="spec-doc"><p><code>Request_aborted</code> is raised if attempting to enqueue a request within a closed http client.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-call"><a href="#val-call" class="anchor"></a><code><span><span class="keyword">val</span> call : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Request/index.html#type-t">Request.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Response/index.html#type-t">Response.t</a> <span class="xref-unresolved">Async</span>.Deferred.t</span></span></code></div><div class="spec-doc"><p><code>call</code> Attempts to perform a HTTP request using the user provided client. If the response contains a &quot;Connection: close&quot; header or if there's an exception when performing the call the client will be closed and should not be used for any future calls. If performing multiple calls on a client, users should ensure to only wait on a response promise if all previous responses have been fully read.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_closed"><a href="#val-is_closed" class="anchor"></a><code><span><span class="keyword">val</span> is_closed : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>is_closed</code> returns if the client has been closed.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-closed"><a href="#val-closed" class="anchor"></a><code><span><span class="keyword">val</span> closed : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Async</span>.Deferred.t</span></span></code></div><div class="spec-doc"><p><code>closed</code> returns a deferred that's resolved when the http client is closed.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-close"><a href="#val-close" class="anchor"></a><code><span><span class="keyword">val</span> close : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Async</span>.Deferred.t</span></span></code></div><div class="spec-doc"><p><code>close</code> initiates shutdown for an http client. Any request that's currently in-flight will be attempt to run, and any pending requests will fail with <a href="Shuttle.Client.Request_aborted">exception</a>.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Oneshot"><a href="#module-Oneshot" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Oneshot/index.html">Oneshot</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Persistent"><a href="#module-Persistent" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Persistent/index.html">Persistent</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Persistent clients, not to be confused with HTTP/1.1 persistent connections are durable clients that maintain a connection to a service and eagerly and repeatedly reconnect if the underlying socket connection is lost.</p></div></div></div></body></html>